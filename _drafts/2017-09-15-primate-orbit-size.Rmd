---
title: "Primate activity pattern and orbit morphology: a phylogenetic analysis of data from Kay & Kirk (2004)"
layout: post
date: 2017-09-29
tags: R morphology evolution PGLS regression
comments: true
---

```{r setup, include=FALSE}
# knitr
#knitr::opts_chunk$set(fig.path = "assets/Rfigs/", comment="> ", fig.align = 'center')
#knitr::opts_knit$set(base.dir = "/Users/nunnlab/Desktop/GitHub/rgriff23.github.io/", base.url = "/")
```

This post revisits the relationship between primate activity pattern and orbit morphology investigated by [Kay & Kirk (2000)](https://www.ncbi.nlm.nih.gov/pubmed/11002207), who found a strong correlation between nocturnal activity pattern and large orbits across a sample of 476 specimens representing 60 primate species. This association is argued to reflect adaptations to the visual system in nocturnal primates, since larger eyeballs enhance visual sensitivity. Kay & Kirk (2000) also found a signficant correlation between nocturnality and a small optic foramen relative to the size of the orbit, which is argued to be an adaptation for greater retinal summation in nocturnal primates. Kay & Kirk (2000) provide a clear explanation of the biology underlying these associations. 

Here, I improve on the analysis presented by Kay & Kirk (2000) in two ways. First, I analyze revised and expanded data on skull length, orbit size, and optic foramen size taken from [Kay & Kirk (2004)](https://link.springer.com/chapter/10.1007/978-1-4419-8873-7_20). This data includes additional specimens to provide more accurate esimates of species means, 33 additional species for a total of *n* = 93, and computes orbit area from orbit diameter in a more realistic way by assuming the orbit is circular rather than square (an odd assumption made by Kay & Kirk 2000). These changes to the data should increase the ability to detect a relationship between activity pattern and orbit morphology. The second improvement to the original analysis is that I account for phylogenetic relationships in the variance-covariance structure of the linear models, i.e., I use phylogenetic generalized least squares (PGLS) rather than ordinary least squares (OLS). This addresses the problem of inflated standard errors and increased risk of Type I errors when phylogenetic autocorrelation is not accounted for in regression models ([Felsenstein 1985](http://www.journals.uchicago.edu/doi/abs/10.1086/284325)). I had to drop 3 species from the analysis due to lack of phylogenetic data, yielding a total of *n* = 90 taxa.

I'm happy to say that my PGLS results produce the same inferences made by Kay & Kirk (2000): both orbit size and relative optic foramen size are significantly associated with activity pattern after controlling for skull length. However, there is severe phylogenetic non-independence in the models, the strength of the relationships as indicated by p-values is drastically reduced when PGLS is used instead of OLS.

To replicate this analysis in R, load the following packages and import the data from my website (the phylogeny comes from [10kTrees](http://10ktrees.nunn-lab.org/)):

```{r}
# load packages
library("caper")
library("ggplot2")

# import data
data <- read.csv("/Users/nunnlab/Desktop/GitHub/rgriff23.github.io/assets/data/kaykirk2000.csv")
tree <- readRDS("/Users/nunnlab/Desktop/GitHub/rgriff23.github.io/assets/Rds/kaykirk2000_tree.Rds")
```

The data includes the following variables: 

- `Genus_species` - Genus and species name
- `Group` - Prosimian or Anthropoid
- `Skull_length` - Prosthion-inion linear distance in mm
- `Orbit_area` - Orbit area in square mm, estimated from orbit diameter
- `Optic_foramen_area` - Optic forament area in square mm
- `Activity_pattern` - Diurnal, cathemeral, or nocturnal
- `Activity_pattern_code` - 0 = Diurnal, 1 = Cathemeral, and 2 = Nocturnal

Below is a scatterplot of orbit size against skull length, with data points colored based on activity pattern. Prosimians are represented by triangles and anthropoids by circles to show the strong phylogenetic pattern in the data. This plot also displays the allometry of orbit size, which makes it necessary to control for skull length in analyses of orbit size:

```{r}
# create factor levels for activiy pattern (ensures desired ordering in plot legend)
data$Activity_pattern <- factor(data$Activity_pattern, levels=c("Diurnal","Cathemeral","Nocturnal"))

# scatterplot of orbit diameter against skull length
ggplot(data, aes(Skull_length, Orbit_area, color=Activity_pattern, shape=Group)) +
  geom_point(alpha=0.5, size=2.5) +
  scale_color_manual(values=c("goldenrod1","red","blue")) +
  xlab("Skull length (mm)") +
  ylab("Orbit area (mm^2)") +
  theme(axis.text=element_text(size=15),
        axis.title=element_text(size=15),
        legend.text=element_text(size=12),
        legend.title=element_text(size=17))
```

This plot illustrates the challenge of disentangling the association between orbit size and activity pattern from the effects of phylogenetic history - most of the nocturnal species are prosimians (blue triangles), and most of the diurnal species are anthropoids (yellow circles). If we fit an OLS model to the data, controlling for skull length by including it in the model, relative orbit size is strongly associated with activity pattern (p = 0.0000000744):

```{r}
# OLS: orbit diameter ~ nocturnal + log body size
mod1 <- lm(Orbit_area ~ Activity_pattern_code + Skull_length, data=data)
summary(mod1)
```

Now let's fit a PGLS model. I allow the model to estimate the phylogenetic signal parameter 'lambda' by specifying `lambda="ML"`. Lambda = 0 if there is no phylogenetic non-independence in the model residuals, and lambda = 1 if the phylogeny provides a good description of the model residuals ([Pagel 1999](https://search.proquest.com/openview/65a6b308bf6477629bc74326dd8d0b01/1?pq-origsite=gscholar&cbl=40569)). 

```{r}
# PGLS: orbit circumference ~ nocturnal + log body size
comp.dat = comparative.data(tree, data, names.col="Genus_species")
mod2 <- pgls(Orbit_area ~ Activity_pattern_code + Skull_length, data=comp.dat, lambda="ML")
summary(mod2)
```

The maximum likelihood estimate of lambda is 1, indicating a high degree of phylogenetic non-independence, and the relationship between orbit area and activity pattern is now barely statistically significant (p = 0.017)

Next, let's compare OLS and PGLS results for relative optic foramen area, beginning with a visualization the relationship between relative optic foramen area versus skull length:

```{r}
# scatterplot of relative optic foramen area against skull length
ggplot(data, aes(Skull_length, Optic_foramen_area/Orbit_area, color=Activity_pattern, shape=Group)) +
  geom_point(alpha=0.5, size=2.5) +
  scale_color_manual(values=c("goldenrod1","red","blue")) +
  xlab("Skull length (mm)") +
  ylab("Optic foramen area / Orbit area") +
  theme(axis.text=element_text(size=15),
        axis.title=element_text(size=15),
        legend.text=element_text(size=12),
        legend.title=element_text(size=17))
```

We can see that the separation between nocturnal prosimians (blue triangles) and diurnal anthropoids (yellow circles) is even more extreme for relative optic foramen size than for orbit area. An OLS model fitted to this data finds extremely strong evidence for a link between relative optic foramen area and activity pattern (p = 0.00000000000000149):

```{r}
# OLS: relative optic foramen size ~ nocturnal + log body size
mod3 <- lm((Optic_foramen_area/Orbit_area) ~ Activity_pattern_code + Skull_length, data=data)
summary(mod3)
```

But if we fit a PGLS model:  

```{r}
# PGLS: relative optic foramen size ~ nocturnal + log body size
mod4 <- pgls((Optic_foramen_area/Orbit_area) ~ Activity_pattern_code + Skull_length, data=comp.dat, lambda="ML")
summary(mod4)
```

The maximum likelihood estimate of lambda is very close to 1, and the relationship between relative optic foramen size and activity pattern is drastically weakened, although it remains highly significant (p = 0.001).

These results uphold the conclusions of Kay & Kirk (2000) while simultaneously illustrating the statistical importance of accounting for autocorrelated data in regression models. In particular, even with 90 species and a striking visual pattern in the data, the relationship between orbit size and activity pattern is barely statistically significant when phylogenetic relationships are incorporated into the model. In fact, the striking visual patterns in the plots are misleading because the datapoints are not statistically independent.

___

**References**

Felsenstein, J., 1985. Phylogenies and the comparative method. The American Naturalist, 125(1), pp.1-15.

Kay, R.F. and Kirk, E.C., 2000. Osteological evidence for the evolution of activity pattern and visual acuity in primates. American Journal of Physical Anthropology, 113(2), pp.235-262.

Kirk, E.C. and Kay, R.F., 2004. The evolution of high visual acuity in the Anthropoidea. In Anthropoid Origins (pp. 539-602). Springer US.

Pagel, M., 1999. Inferring the historical patterns of biological evolution. Nature, 401(6756), p.877.
